# 4.MFC工程添加激光跟踪仪

## 1.添加相关文件

LtcCPPEventSink.h  
LtcCPPEventSink.cpp  
LTControl.dll  
LTControl.tlb  
LTControl.tlh  
LTControl.tli  

## 2.在.h文件中添加

```c++
#include "LtcCPPEventSink.h"
#import "LTControl.dll" no_namespace, named_guids, inject_statement("#pragma pack(4)")
#include "afxwin.h"

```

## 3.在.cpp中添加

```c++
#include "LtcCPPEventSink.h"
#include <Afxctl.h>
#define CALL(command) \
    try {command; m_bLastCmdFailed =FALSE; if (!m_bIsInitializing) Beep(100, 100);} catch(_com_error &e) {Beep(4000, 100); m_bLastCmdFailed = TRUE; AfxMessageBox((LPCTSTR)e.Description());}

#define CALL_NO_ERRMSG(command) \
    try {command; Beep(100, 100);} catch(_com_error &e) {CString sDesc = (LPCTSTR)e.Description(); TRACE(sDesc);} // do nothing except trace out description

#define CALL_HR(command, hr) \
    try {hr = command; m_bLastCmdFailed = FALSE; if (!m_bIsInitializing) Beep(100, 100);} catch(_com_error &e) {Beep(4000, 100); m_bLastCmdFailed = TRUE; AfxMessageBox((LPCTSTR)e.Description());}
```
